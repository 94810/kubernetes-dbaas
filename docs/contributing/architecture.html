<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<title data-react-helmet="true">Architecture | Kubernetes Database-as-a-Service</title><meta data-react-helmet="true" property="og:url" content="https://criscola.github.io/kubernetes-dbaas/docs/contributing/architecture"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Architecture | Kubernetes Database-as-a-Service"><meta data-react-helmet="true" name="description" content="This Operator is written in Go with help of the Operator-SDK."><meta data-react-helmet="true" property="og:description" content="This Operator is written in Go with help of the Operator-SDK."><link data-react-helmet="true" rel="shortcut icon" href="/kubernetes-dbaas/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://criscola.github.io/kubernetes-dbaas/docs/contributing/architecture"><link data-react-helmet="true" rel="alternate" href="https://criscola.github.io/kubernetes-dbaas/docs/contributing/architecture" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://criscola.github.io/kubernetes-dbaas/docs/contributing/architecture" hreflang="x-default"><link rel="stylesheet" href="/kubernetes-dbaas/assets/css/styles.2cf4fd45.css">
<link rel="preload" href="/kubernetes-dbaas/assets/js/runtime~main.10a758c3.js" as="script">
<link rel="preload" href="/kubernetes-dbaas/assets/js/main.8cec7e9a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kubernetes-dbaas/"><img src="/kubernetes-dbaas/img/logo.svg" alt="Kubernetes Database-as-a-Service logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/kubernetes-dbaas/img/logo.svg" alt="Kubernetes Database-as-a-Service logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Home</b></a><a class="navbar__item navbar__link navbar__link--active" href="/kubernetes-dbaas/docs/overview">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/bedag/kubernetes-dbaas" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kubernetes-dbaas/docs/overview">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DBMS configuration</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Operator configuration</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Operator deployment</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes-dbaas/docs/usage">Usage</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Contributing</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes-dbaas/docs/contributing/how-to-contribute">How to contribute</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes-dbaas/docs/contributing/branching-standard">Branching standard</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/kubernetes-dbaas/docs/contributing/architecture">Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes-dbaas/docs/contributing/testing">Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes-dbaas/docs/contributing/ci">CI pipeline</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes-dbaas/docs/legals">Legals</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Architecture</h1></header><p>This Operator is written in Go with help of the <a href="https://sdk.operatorframework.io/" target="_blank" rel="noopener noreferrer">Operator-SDK</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="package-organization"></a>Package organization<a class="hash-link" href="#package-organization" title="Direct link to heading">#</a></h2><p><img alt="System architecture organization in packages" src="/kubernetes-dbaas/assets/images/03_system_diagram-96476803e38117420b6c4e8bbd76f09a.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="controller"></a>Controller<a class="hash-link" href="#controller" title="Direct link to heading">#</a></h3><p>The <code>controllers</code> package is responsible for binding the business rules of the Operator with the
business rules dictated by the stored procedures and for communicating with the Kubernetes API by
reconciling inbound requests triggered by events. This is where the main logic lives.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="kubernetes-api-extensions"></a>Kubernetes API extensions<a class="hash-link" href="#kubernetes-api-extensions" title="Direct link to heading">#</a></h3><p>Folder <code>apis</code> contains 3 distinct packages, <code>config/v1</code>, <code>database/v1</code> and <code>databaseclass/v1</code>. They contain
the types related to the extension applied to the Kubernetes API, i.e. they contain the types of the new
API objects. They are the entities and contain no business logic. They can be reused freely throughout
the application. Each of these 3 packages contain two other files as well: groupversion_info.go
contains information relative to the versioning of the resources and is used by the Kubernetes API,
while zz_generated.deepcopy.go contains autogenerated code by the Operator SDK used to allow
serialization from and to the Kubernetes API and the Operator. These two files can be found in the
other 2 subpackages as well. Each of the aforementioned packages have their relative Custom Resource
Definition (CRD) configuration file.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="core-packages"></a>Core packages<a class="hash-link" href="#core-packages" title="Direct link to heading">#</a></h3><p>Folder <code>pkg</code> is, by Go convention, a folder which is supposed to contain packages that can be imported freely,
i.e. it should not contain any global variables, and it is not tightly coupled with a
single implementation. It contains 4 packages:</p><ul><li>Package <code>database</code> contains all the code relative to the database. It contains the DBMS drivers used
to communicate with the DBMS solutions, as well as the types abstracting the various operations,
input/output rendering and so on.</li></ul><p><img alt="Database driver organizations" src="/kubernetes-dbaas/assets/images/04_system_diagram-bae8410f2e475dcdd0543aedf55091a1.png"></p><ul><li>Package <code>pool</code> contains the code relative to the DBMS connection pool. It only holds the DBMS drivers
structs responsible for communicating with the DBMS endpoints.</li><li>Package <code>test</code> contains some utility code useful for testing.</li><li>Package <code>typeutil</code> contains constants and very generic utility functions (boilerplate). Constants are
mainly useful for avoiding hard-coding error messages etc.</li></ul><p>During the course of the project, it was attempted to build a robust system architecture by following
software engineering principles, especially the SOLID principles.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="command-line-interface"></a>Command line interface<a class="hash-link" href="#command-line-interface" title="Direct link to heading">#</a></h3><p>Package <code>cmd</code> contains the code relative to the command line interface of the Operator such as reading
command line flags, activating/deactivating functionalities, starting the controller and the webhooks,
initializing the logger, creating the pool of DBMS connection and so forth. We make use of the excellent
<a href="https://github.com/spf13/viper" target="_blank" rel="noopener noreferrer">Viper</a> library to load flags and configuration files and
<a href="https://github.com/spf13/cobra" target="_blank" rel="noopener noreferrer">Cobra</a> for the actual CLI implementation.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="internal"></a>Internal<a class="hash-link" href="#internal" title="Direct link to heading">#</a></h3><p>Folder <code>internal</code> is, by Go convention, a package which cannot be imported from outside this project.
It contains the package <code>logging</code> which contains customized logger implementations for the Operator.
We use <a href="https://github.com/uber-go/zap" target="_blank" rel="noopener noreferrer">zap</a> for the logging back-end and <a href="https://github.com/go-logr/logr" target="_blank" rel="noopener noreferrer">logr</a> as a
front-end (faÃ§ade).</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/bedag/kubernetes-dbaas/edit/main/website/docs/contributing/architecture.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kubernetes-dbaas/docs/contributing/branching-standard"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Branching standard</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kubernetes-dbaas/docs/contributing/testing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Testing Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#package-organization" class="table-of-contents__link">Package organization</a><ul><li><a href="#controller" class="table-of-contents__link">Controller</a></li><li><a href="#kubernetes-api-extensions" class="table-of-contents__link">Kubernetes API extensions</a></li><li><a href="#core-packages" class="table-of-contents__link">Core packages</a></li><li><a href="#command-line-interface" class="table-of-contents__link">Command line interface</a></li><li><a href="#internal" class="table-of-contents__link">Internal</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/kubernetes-dbaas/docs/overview">Documentation</a></li><li class="footer__item"><a href="https://pkg.go.dev/github.com/bedag/kubernetes-dbaas" target="_blank" rel="noopener noreferrer" class="footer__link-item">Godocs</a></li><li class="footer__item"><a class="footer__link-item" href="/kubernetes-dbaas/docs/contributing/how-to-contribute">Contributing</a></li><li class="footer__item"><a class="footer__link-item" href="/kubernetes-dbaas/docs/legals">Legals</a></li></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/bedag/kubernetes-dbaas" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Source code<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/bedag/kubernetes-dbaas/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Issue tracker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://hub.docker.com/r/bedag/kubernetes-dbaas" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>DockerHub repository<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="#" class="footer__link-item">ArtifactHub repository</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.bedag.ch" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Bedag Informatik AG<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/bedag" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.instagram.com/bedaginformatik" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 <a href="https://github.com/criscola">Cristiano Colangelo</a> â€” Developed for Bedag Informatik AG. <br></div></div></div></footer></div>
<script src="/kubernetes-dbaas/assets/js/runtime~main.10a758c3.js"></script>
<script src="/kubernetes-dbaas/assets/js/main.8cec7e9a.js"></script>
</body>
</html>