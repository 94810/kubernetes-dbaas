# End-user guide

## Prerequisites

You have the Operator ready and deployed. See [the system administrator guide.](sysadmin_guide.md)

## Steps

1. Create a custom resource configuration, e.g. `my-db.yaml`

Here's an example;

```
apiVersion: dbaas.bedag.ch/v1
kind: Database
metadata:
  name: database-sample  
spec:
  endpoint: us-sqlserver-test
```

- `endpoint` tells the Operator where to create the operator. Your endpoint names are configured in the Operator configuration and should be properly documented inside of your organization.

- You can supply other key values pairs if your Operator configuration is prepared to read them.

  - Example:

    ```
    apiVersion: dbaas.bedag.ch/v1
    kind: Database
    metadata:
      name: database-sample  
    spec:
      endpoint: us-sqlserver-test
      params:
        myCustomUserParam: "myvalue"
    ```

2. Apply the configuration in your cluster:

```
kubectl apply -f mycrd.yaml
```

To delete the configuration:

```
kubectl delete -f mycrd.yaml
```

## Troubleshooting

In case your DB wasn't created successfully, the Operator will write some information in the resource status field.

```
kubectl get database database-sample -o yaml
```

- `LastError`: tells you what's the last error generated by the Operator. If not nil, the resource is in an error state.
- `LastErrorUpdateCount`: specifies how many times LastError was updated. At the moment, the operation generating error will be retried 14 times with a pause of 3 seconds between retries (subject to change in future releases).
- `LastUpdate`: tells you when was the last time (Unix time format) LastError was updated.
- `Unrecoverable`: if set to true, the Operator was unable to fix the error itself and manual intervention is required. No additional retries will be carried out for this resource.

